<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Microsoft Azure | Badrap docs</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Badrap documentation site">
    
    <link rel="preload" href="/assets/css/0.styles.b2fdc9f3.css" as="style"><link rel="preload" href="/assets/js/app.fb5eb82b.js" as="script"><link rel="preload" href="/assets/js/2.fe5354e1.js" as="script"><link rel="preload" href="/assets/js/3.20e608de.js" as="script"><link rel="prefetch" href="/assets/js/10.ba2a2928.js"><link rel="prefetch" href="/assets/js/11.30f38af4.js"><link rel="prefetch" href="/assets/js/12.6634235f.js"><link rel="prefetch" href="/assets/js/13.fcf78edc.js"><link rel="prefetch" href="/assets/js/14.31a2650b.js"><link rel="prefetch" href="/assets/js/15.f1a9fc68.js"><link rel="prefetch" href="/assets/js/16.e447bcc7.js"><link rel="prefetch" href="/assets/js/17.d1f3bbef.js"><link rel="prefetch" href="/assets/js/18.037009d6.js"><link rel="prefetch" href="/assets/js/19.60274f08.js"><link rel="prefetch" href="/assets/js/20.c569afc5.js"><link rel="prefetch" href="/assets/js/21.babbc1be.js"><link rel="prefetch" href="/assets/js/22.29e86263.js"><link rel="prefetch" href="/assets/js/23.71a669c4.js"><link rel="prefetch" href="/assets/js/24.57768bec.js"><link rel="prefetch" href="/assets/js/25.5135ea72.js"><link rel="prefetch" href="/assets/js/26.2e5f8397.js"><link rel="prefetch" href="/assets/js/27.1ee85613.js"><link rel="prefetch" href="/assets/js/28.c0426c34.js"><link rel="prefetch" href="/assets/js/29.8c6508f1.js"><link rel="prefetch" href="/assets/js/30.c36b8f47.js"><link rel="prefetch" href="/assets/js/31.c3e9615c.js"><link rel="prefetch" href="/assets/js/32.993c3ee3.js"><link rel="prefetch" href="/assets/js/33.109fa55d.js"><link rel="prefetch" href="/assets/js/34.4e153806.js"><link rel="prefetch" href="/assets/js/35.f2e0da6d.js"><link rel="prefetch" href="/assets/js/36.96f9cae7.js"><link rel="prefetch" href="/assets/js/37.3be29578.js"><link rel="prefetch" href="/assets/js/38.48cd3275.js"><link rel="prefetch" href="/assets/js/39.33991ffb.js"><link rel="prefetch" href="/assets/js/4.b4c4fa03.js"><link rel="prefetch" href="/assets/js/40.b07eb221.js"><link rel="prefetch" href="/assets/js/41.898b37ed.js"><link rel="prefetch" href="/assets/js/42.f2d99172.js"><link rel="prefetch" href="/assets/js/43.757b80e9.js"><link rel="prefetch" href="/assets/js/44.130749a1.js"><link rel="prefetch" href="/assets/js/45.054c8b97.js"><link rel="prefetch" href="/assets/js/46.9c2248e3.js"><link rel="prefetch" href="/assets/js/47.2d43bd06.js"><link rel="prefetch" href="/assets/js/48.65a54cd4.js"><link rel="prefetch" href="/assets/js/49.1d740960.js"><link rel="prefetch" href="/assets/js/5.53964656.js"><link rel="prefetch" href="/assets/js/50.660b5659.js"><link rel="prefetch" href="/assets/js/51.2a54cf32.js"><link rel="prefetch" href="/assets/js/52.303b2a2b.js"><link rel="prefetch" href="/assets/js/53.3778b0b5.js"><link rel="prefetch" href="/assets/js/54.1766c55a.js"><link rel="prefetch" href="/assets/js/55.0b54e1d6.js"><link rel="prefetch" href="/assets/js/56.7df1aa87.js"><link rel="prefetch" href="/assets/js/57.3b03a9b5.js"><link rel="prefetch" href="/assets/js/58.603b72a3.js"><link rel="prefetch" href="/assets/js/59.a1be2f86.js"><link rel="prefetch" href="/assets/js/6.52e70600.js"><link rel="prefetch" href="/assets/js/60.48961669.js"><link rel="prefetch" href="/assets/js/61.1ea6098b.js"><link rel="prefetch" href="/assets/js/62.4f35fbfd.js"><link rel="prefetch" href="/assets/js/63.90cc67ca.js"><link rel="prefetch" href="/assets/js/64.81524108.js"><link rel="prefetch" href="/assets/js/65.b7d9a3d6.js"><link rel="prefetch" href="/assets/js/66.dfcb5cd6.js"><link rel="prefetch" href="/assets/js/67.a7011c17.js"><link rel="prefetch" href="/assets/js/68.8e5b9cbe.js"><link rel="prefetch" href="/assets/js/7.ec65add6.js"><link rel="prefetch" href="/assets/js/8.55e0efed.js"><link rel="prefetch" href="/assets/js/9.42ba2572.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b2fdc9f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/badrap-logo.png" alt="Badrap docs" class="logo"> <span class="site-name can-hide">Badrap docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://badrap.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  badrap.io
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/apps/azure.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/fi/" class="nav-link">
  Suomi
</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://badrap.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  badrap.io
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/apps/azure.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/fi/" class="nav-link">
  Suomi
</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Microsoft Azure</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/apps/azure.html#install-the-azure-app-in-badrap" class="sidebar-link">Install the Azure app in Badrap</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/apps/azure.html#using-the-azure-cli" class="sidebar-link">Using the Azure CLI</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/apps/azure.html#using-azure-portal" class="sidebar-link">Using Azure Portal</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/apps/azure.html#uninstalling-the-app" class="sidebar-link">Uninstalling the app</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/apps/azure.html#cleaning-up-via-azure-cli" class="sidebar-link">Cleaning up via Azure CLI</a></li><li class="sidebar-sub-header"><a href="/apps/azure.html#cleaning-up-via-azure-portal" class="sidebar-link">Cleaning up via Azure Portal</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="microsoft-azure"><a href="#microsoft-azure" class="header-anchor">#</a> Microsoft Azure</h1> <p>This app allows you to synchronize your Microsoft Azure assets into Badrap and to receive security notifications about them. The app fetches a list of your organization's public network assets from your Azure installation with your consent, and adds those assets under your Badrap user account. The asset types listed are:</p> <ul><li>Public IP addresses from your Azure installation</li> <li>DNS records (A, AAAA, CNAME, MX, NS) from all public DNS zones managed by Azure</li> <li>Azure DNS alias records</li></ul> <h2 id="install-the-azure-app-in-badrap"><a href="#install-the-azure-app-in-badrap" class="header-anchor">#</a> Install the Azure app in Badrap</h2> <p>Anyone can install the Azure app in Badrap, but you will need Global Administrator, Application Administrator or Cloud Application Administrator level privileges to enable the app to access your Azure installation and to list your assets from there. If you do not have administrator role privileges, refer your administrator to these instructions and ask them to help you with the app configuration.</p> <ol><li><p>Open the <a href="https://badrap.io/apps/azure" target="_blank" rel="noopener noreferrer">Azure app page<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
</p><div style="text-align:center;"><img src="/assets/img/azure-10-install.63f89a36.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>The app asks for your consent to create &amp; manage new assets. Click <strong>Install the app</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-20-consent.6525f3a0.png" style="max-width:95%;width:480px;"></div><p></p> <p>The Azure app is now installed. Next, you have to create a service principal for the app in your Azure installation, and to provide its configuration details to the app settings. You can do this either by using the Azure CLI (incredibly easy) or your Azure Portal (still easy).</p></li></ol> <h2 id="using-the-azure-cli"><a href="#using-the-azure-cli" class="header-anchor">#</a> Using the Azure CLI</h2> <p>Note that installing Azure CLI to your computer is outside of the scope of this guide. You can use <a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli" target="_blank" rel="noopener noreferrer">Microsoft's Azure CLI installation instructions<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to get started if you haven't installed it previously.</p> <ol><li><p>Log into Azure using your Azure CLI utility.</p> <div class="language- extra-class"><pre class="language-text"><code>az login
</code></pre></div></li> <li><p>List your subscription details:</p> <div class="language- extra-class"><pre class="language-text"><code>az account show
</code></pre></div><p>The listing will look like this:</p> <div class="language- extra-class"><pre class="language-text"><code>{
  &quot;environmentName&quot;: &quot;AzureCloud&quot;,
  &quot;homeTenantId&quot;: &quot;aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee&quot;,
  &quot;id&quot;: &quot;11111111-2222-3333-4444-555555666666&quot;,
  &quot;isDefault&quot;: true,
  &quot;managedByTenants&quot;: [],
  &quot;name&quot;: &quot;Pay-As-You-Go&quot;,
  &quot;state&quot;: &quot;Enabled&quot;,
  &quot;tenantId&quot;: &quot;aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee&quot;,
  &quot;user&quot;: {
    &quot;name&quot;: &quot;adminroleuser@example.com&quot;,
    &quot;type&quot;: &quot;user&quot;
  }
}
</code></pre></div><p>Make a note of the <strong>id</strong> field value (subscription ID) for the next step. If you want to add multiple subscriptions, make a note of all of their IDs.</p></li> <li><p>Use the <code>az ad sp</code> command to create an application as a service principal with Reader role privileges. Substitute <code>{subscription_id}</code> in the example below with the <strong>id</strong> value you noted down previously. Note that the <code>--name</code> parameter is optional and you can define any name you want for the service principal.</p> <div class="language- extra-class"><pre class="language-text"><code>az ad sp create-for-rbac --role &quot;Reader&quot; --scopes /subscriptions/{subscription_id} --name http://BadrapAzureApp
</code></pre></div><p>The output will look like this:</p> <div class="language- extra-class"><pre class="language-text"><code>Creating 'Reader' role assignment under scope '/subscriptions/11111111-2222-3333-4444-555555666666'
  Retrying role assignment creation: 1/36
The output includes credentials that you must protect. Be sure that you do not include these credentials in your code or
check the credentials into your source control. For more information, see https://aka.ms/azadsp-cli
{
  &quot;appId&quot;: &quot;aabbccdd-1122-3344-5566-eeeeffff7777&quot;,
  &quot;displayName&quot;: &quot;BadrapAzureApp&quot;,
  &quot;name&quot;: &quot;http://BadrapAzureApp&quot;,
  &quot;password&quot;: &quot;****************************&quot;,
  &quot;tenant&quot;: &quot;aaaaaaaa-bbbb-cccc-dddd-eeeeeeeeeeee&quot;
}
</code></pre></div><p>If you want to add access to multiple subscriptions, simply include all of their IDs after the <code>--scopes</code> parameter, separated with spaces:</p> <div class="language- extra-class"><pre class="language-text"><code>az ad sp create-for-rbac --role &quot;Reader&quot; --scopes /subscriptions/{subscription_id1} /subscriptions/{subscription_id2} --name http://BadrapAzureApp
</code></pre></div><p>If you want to restrict the permissions of the service principal even further, instead of the default Reader role you can create a custom role and assign it to the service principal. The custom role needs to have permissions to only a few resources. First, create the service principal without assigning any role to it.</p> <div class="language- extra-class"><pre class="language-text"><code>az ad sp create-for-rbac --skip-assignment --scopes /subscriptions/{subscription_id} --name http://BadrapAzureApp
</code></pre></div><p>Then, create your custom role with only minimal privileges:</p> <div class="language- extra-class"><pre class="language-text"><code>az role definition create --role-definition '{
    &quot;Name&quot;: &quot;CustomReaderBadrapApp&quot;,
    &quot;Description&quot;: &quot;Custom restricted Reader role for Badrap Azure app&quot;,
    &quot;AssignableScopes&quot;: [
            &quot;/subscriptions/445566eeff-2222-aaaa-ffff-112233aabbcc&quot;
    ],
    &quot;Actions&quot;: [
        &quot;Microsoft.Network/publicIPAddresses/read&quot;,
        &quot;Microsoft.Network/dnszones/read&quot;,
        &quot;Microsoft.Network/dnszones/all/read&quot;
    ],
    &quot;NotActions&quot;: [],
    &quot;DataActions&quot;: [],
    &quot;NotDataActions&quot;: []
}'
</code></pre></div><p>Lastly, assign the custom role to the service principal you created earlier:</p> <div class="language- extra-class"><pre class="language-text"><code>az role assignment create --role &quot;CustomReaderBadrapApp&quot; --assignee http://BadrapAzureApp --scope /subscriptions/{subscription_id}
</code></pre></div></li> <li><p>Under your Badrap Azure app settings, add your account details.
</p><div style="text-align:center;"><img src="/assets/img/azure-30-add-account.e0af29c2.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Copy the <strong>tenant</strong>, <strong>appId</strong> and <strong>password</strong> values into the app settings:</p> <ul><li>Tenant ID: <code>tenant</code></li> <li>Application ID: <code>appId</code></li> <li>Client Secret: <code>password</code></li></ul></li> <li><p>In a few minutes after the Badrap Azure app has been configured into use, you should see a listing of your Azure assets under <a href="https://badrap.io/assets" target="_blank" rel="noopener noreferrer">My Assets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
</p><div style="text-align:center;"><img src="/assets/img/azure-99-assets.8ce8c83b.png" style="max-width:95%;width:480px;"></div><p></p></li></ol> <h2 id="using-azure-portal"><a href="#using-azure-portal" class="header-anchor">#</a> Using Azure Portal</h2> <ol><li><p>Log into your <a href="https://portal.azure.com" target="_blank" rel="noopener noreferrer">Azure Portal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Select Azure Active Directory from the sidebar.
</p><div style="text-align:center;"><img src="/assets/img/azure-50-portal.35629939.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Go to <strong>App Registrations</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-54-appreg.b1377e84.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Click <strong>New registration</strong>. Enter the following details:</p> <ul><li>Name: Badrap Azure App</li> <li>Supported Account Types: Accounts in this organizational directory only (your organization only)</li> <li>Redirect URI (optional): leave blank
<div style="text-align:center;"><img src="/assets/img/azure-58-newreg.d2fb7a62.png" style="max-width:95%;width:480px;"></div></li></ul></li> <li><p>Click <strong>Register</strong> to complete the new app registration.</p></li> <li><p>Now, give Reader permissions to the application. Go to <strong>Subscriptions</strong> via the Azure Portal top search bar or via the left sidebar.
</p><div style="text-align:center;"><img src="/assets/img/azure-60-search-subs.19757f85.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Choose the subscription you want to use. If you have multiple subscriptions that you want to add, you can just repeat steps 6-10 to add access to all of them.
</p><div style="text-align:center;"><img src="/assets/img/azure-64-choose-sub.418f84e6.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Select <strong>Access Control (IAM)</strong> in the subscription page.
</p><div style="text-align:center;"><img src="/assets/img/azure-68-iam.0885de29.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Click <strong>Add</strong> and select <strong>Add role assignment</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-70-add-role.f46f98f9.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>For &quot;Role&quot;, select <strong>Reader</strong>. For &quot;Assign access to&quot;, select <strong>User, group or service principal</strong>.</p></li> <li><p>In the Select menu, type the name of the application you created in the previous step (e.g. &quot;Badrap Azure App&quot;) and click on the search result. The app should now appear in the &quot;Selected members&quot; list. Then click <strong>Save</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-74-role-details.a22bcbe7.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>If you want to restrict the permissions of the service principal even further from the default Reader role, you can create a custom role and assign it to the service principal. The custom role needs to have permissions to only a few resources. First, under the <strong>Access Control (IAM)</strong> page under your subscription (see step 7 above), create your custom role with only minimal privileges by clicking <strong>Add</strong> and selecting <strong>Add custom role</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-75-add-custom-role.43630697.png" style="max-width:95%;width:480px;"></div><p></p> <p>Under the &quot;Basics&quot; tab in the &quot;Create new role&quot; dialog, create a name for your role under <strong>Custom role name</strong>, e.g. &quot;CustomReaderBadrapApp&quot;. For <strong>Description</strong>, write down the purpose of the custom role, e.g. &quot;Custom restricted Reader role for Badrap Azure app service principal&quot;. For <strong>Baseline permissions</strong>, select <strong>Start from scratch</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-76-custom-role-basics.476314cc.png" style="max-width:95%;width:480px;"></div><p></p> <p>Under the &quot;JSON&quot; tab in the &quot;Create new role&quot; dialog, edit the JSON to look like this:</p> <div class="language- extra-class"><pre class="language-text"><code>{
    &quot;properties&quot;: {
        &quot;roleName&quot;: &quot;CustomReaderBadrapApp&quot;,
         &quot;description&quot;: &quot;Custom restricted Reader role for Badrap Azure app&quot;,
        &quot;assignableScopes&quot;: [
             &quot;/subscriptions/445566eeff-2222-aaaa-ffff-112233aabbcc&quot;
        ],
        &quot;permissions&quot;: [
            {
                &quot;actions&quot;: [
                    &quot;Microsoft.Network/publicIPAddresses/read&quot;,
                    &quot;Microsoft.Network/dnszones/read&quot;,
                    &quot;Microsoft.Network/dnszones/all/read&quot;
                ],
                &quot;notActions&quot;: [],
                &quot;dataActions&quot;: [],
                &quot;notDataActions&quot;: []
            }
        ]
    }
}
</code></pre></div><div style="text-align:center;"><img src="/assets/img/azure-77-custom-role-json.748d4236.png" style="max-width:95%;width:480px;"></div> <p>Review the custom role one more time in the <strong>Review+create</strong> tab, and then select <strong>Create</strong>.</p> <p>Then, assign the custom role to the app service principal by following steps 8-10 above, but substituting your custom role name (e.g. &quot;CustomReaderBadrapApp&quot;) in place of the Reader role in step 9.</p></li> <li><p>After you have assigned the necessary role for the service principal, you need to create a client secret for the app. Under <strong>App Registrations</strong>, select the application you created.
</p><div style="text-align:center;"><img src="/assets/img/azure-78-select-app.5fe5a4ae.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Note down the <strong>Directory (tenant) ID</strong> and <strong>Application (client) ID</strong> values.
</p><div style="text-align:center;"><img src="/assets/img/azure-80-copy-values.bc0d43aa.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Under the same app, select <strong>Certificates and Secrets</strong> in the Manage menu.</p></li> <li><p>Under &quot;Client secrets&quot;, click on <strong>New Client Secret</strong>.</p></li> <li><p>For the description field, you can use e.g. <code>badrapClientSecret</code>. Select a suitable time for expiration (e.g. one year), and click <strong>Add</strong>.</p></li> <li><p>Note down the <strong>Value</strong> field from the generated client secret.
</p><div style="text-align:center;"><img src="/assets/img/azure-84-client-secret.767757b9.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Under your Badrap Azure app settings, add a new account. Copy the <strong>Directory (tenant) ID</strong>, <strong>Application (client) ID</strong> and <strong>client secret</strong> values you noted down earlier into the Badrap Azure app settings.
</p><div style="text-align:center;"><img src="/assets/img/azure-30-add-account.e0af29c2.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Click <strong>Add account</strong> to save your settings.</p></li> <li><p>In a few minutes after the app has been configured into use, you should see a listing of your Azure assets under <a href="https://badrap.io/assets" target="_blank" rel="noopener noreferrer">My Assets<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.
</p><div style="text-align:center;"><img src="/assets/img/azure-99-assets.8ce8c83b.png" style="max-width:95%;width:480px;"></div><p></p></li></ol> <h2 id="uninstalling-the-app"><a href="#uninstalling-the-app" class="header-anchor">#</a> Uninstalling the app</h2> <p>If you want to stop using the Badrap Azure app, you should uninstall it from your Badrap <a href="https://badrap.io/apps/azure" target="_blank" rel="noopener noreferrer">Azure app page<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Then you can clean up the app configuration from your Azure AD installation using either Azure CLI or your Azure Portal dashboard.</p> <h3 id="cleaning-up-via-azure-cli"><a href="#cleaning-up-via-azure-cli" class="header-anchor">#</a> Cleaning up via Azure CLI</h3> <ol><li>If you want to clean up your Azure configuration using the Azure CLI, just delete the service principal with the <code>az ad sp delete</code> command:<div class="language- extra-class"><pre class="language-text"><code>az ad sp delete --id http://BadrapAzureApp
</code></pre></div>The output of the command should look like this:<div class="language- extra-class"><pre class="language-text"><code>Removing role assignments
</code></pre></div></li> <li>If you assigned a custom role for the service principal during the app registration, you can delete the custom role with this CLI command:<div class="language- extra-class"><pre class="language-text"><code>az role definition delete --name &quot;CustomReaderBadrapApp&quot;
</code></pre></div>You've now successfully cleaned up your Azure configuration.</li></ol> <h3 id="cleaning-up-via-azure-portal"><a href="#cleaning-up-via-azure-portal" class="header-anchor">#</a> Cleaning up via Azure Portal</h3> <ol><li><p>If you want to clean up your Azure configuration using your <a href="https://portal.azure.com" target="_blank" rel="noopener noreferrer">Azure Portal<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, first log into the portal and select Azure Active Directory from the sidebar.
</p><div style="text-align:center;"><img src="/assets/img/azure-50-portal.35629939.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Navigate to <strong>App Registrations</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-90-appreg-cleanup.15c0cd4d.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>Click on the app that you created earlier, e.g. &quot;Badrap Azure App&quot;.</p></li> <li><p>Select <strong>Delete</strong> from the actions at the top.
</p><div style="text-align:center;"><img src="/assets/img/azure-92-appreg-delete.e9c4be97.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>This action will disable the app registration and move the app under the <strong>Deleted applications</strong> list on the App Registrations page.</p></li> <li><p>To delete the app registration and all its dependencies permanently, go to &quot;Deleted applications&quot;, select the application (e.g. &quot;Badrap Azure App&quot;), and then choose <strong>Delete permanently</strong>.
</p><div style="text-align:center;"><img src="/assets/img/azure-94-appreg-delete-perm.a75fc06e.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>If you created a custom role for your service principal instead of using the default Reader role, go to &quot;Subscriptions&quot; view, select your subscription, go to the &quot;Access control (IAM)&quot; menu, select &quot;Roles&quot;, search for your custom role (e.g. &quot;CustomReaderBadrapApp&quot;), select the custom role, and click &quot;Remove&quot;.
</p><div style="text-align:center;"><img src="/assets/img/azure-96-customrole-remove.0c1aab02.png" style="max-width:95%;width:480px;"></div><p></p></li> <li><p>You've now successfully cleaned up your Azure configuration.</p></li></ol></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/badrap/docs.badrap.io/edit/main/docs/apps/azure.md" target="_blank" rel="noopener noreferrer">Edit this page on GitHub</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.fb5eb82b.js" defer></script><script src="/assets/js/2.fe5354e1.js" defer></script><script src="/assets/js/3.20e608de.js" defer></script>
  </body>
</html>
